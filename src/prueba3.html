<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba</title>

    <link rel="stylesheet" href="../dist/styles.css">
</head>

<body>

    <main class="container mx-auto px-4 py-8 flex justify-center items-center">
        <!-- EJEMPLOS DE MARCADO -->

        <!-- Grupo "header": solo un menú abierto a la vez en este grupo -->
        <div class="relative">
            <button class="px-3 py-2 bg-blue-600 text-white rounded" data-dropdown-toggle
                data-target="#userMenu">Opciones</button>

            <div id="userMenu" data-dropdown data-dd-group="header"
                class="hidden absolute mt-2 w-48 rounded-md border bg-white shadow">
                <button class="block w-full text-left px-3 py-2 hover:bg-gray-100">Opcion</button>

                <!-- Item con submenú -->
                <div class="relative">
                    <button class="block w-full text-left px-3 py-2 hover:bg-gray-100" data-dropdown-subtoggle
                        data-target="#userSub1">
                        Mover a ▸
                    </button>
                    <div id="userSub1" data-dropdown-submenu
                        class="hidden absolute left-full top-0 mt-0 ml-1 w-48 rounded-md border bg-white shadow">

                        <!-- Radio button de seleccion -->
                        <div class="flex items-center px-3 py-2 bg-blue-600/10">
                            <input type="radio" name="userOptions" id="userOption1" class="mr-2" disabled />
                            <label for="userOption1" class="cursor-pointer">Nuevos</label>
                        </div>
                        <div class="flex items-center px-3 py-2 bg-green-400/10">
                            <input type="radio" name="userOptions" id="userOption2" class="mr-2" />
                            <label for="userOption2" class="cursor-pointer">En progreso</label>
                        </div>
                        <div class="flex items-center px-3 py-2 bg-red-400/10">
                            <input type="radio" name="userOptions" id="userOption3" class="mr-2" />
                            <label for="userOption3" class="cursor-pointer">Bloqueado</label>
                        </div>
                    </div>
                </div>

                <button class="block w-full text-left text-red-600 px-3 py-2 hover:bg-gray-100">Eliminar</button>
            </div>
        </div>

        <!-- Otro grupo "nav": independiente del grupo "header" -->
        <div class="relative">
            <button class="px-3 py-2 bg-slate-700 text-white rounded" data-dropdown-toggle
                data-target="#navMenu">Menú</button>

            <div id="navMenu" data-dropdown data-dd-group="nav"
                class="hidden absolute mt-2 w-40 rounded-md border bg-white shadow">
                <button class="block w-full text-left px-3 py-2 hover:bg-gray-100">Inicio</button>
                <button class="block w-full text-left px-3 py-2 hover:bg-gray-100">Acerca</button>
            </div>
        </div>

        <div class="relative" data-dd-root>

            <button
                class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-cyan-500/70 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-slate-800 rounded-md p-1 transition"
                aria-label="Opciones de la tarea" data-dropdown-toggle data-target="#cardOption1">
                Opcion plus
            </button>

            <div id="cardOption1" data-dropdown data-dd-group="header"
                class="hidden absolute mt-2 w-48 rounded-md border bg-white shadow">
                <button
                    class="block w-full rounded px-3 py-2 text-left hover:bg-gray-100 dark:hover:bg-gray-700">Ver</button>
                <button
                    class="block w-full rounded px-3 py-2 text-left hover:bg-gray-100 dark:hover:bg-gray-700">Editar</button>
                <button
                    class="block w-full rounded px-3 py-2 text-left hover:bg-gray-100 dark:hover:bg-gray-700">Bloquear</button>
                <div class="my-1 h-px bg-gray-200 dark:bg-gray-700"></div>

                <!-- Item con submenú -->
                <div class="relative">
                    <button class="block w-full rounded px-3 py-2 text-left hover:bg-gray-100 dark:hover:bg-gray-700"
                        data-dropdown-subtoggle data-target="#moverTo">
                        Mover a ▸
                    </button>
                    <div id="moverTo" data-dropdown-submenu
                        class="hidden absolute left-full top-0 mt-0 ml-1 w-48 rounded-md border bg-white shadow">

                        <!-- Radio button de seleccion -->
                        <div class="flex items-center px-3 py-2 bg-blue-600/10">
                            <input type="radio" name="userOptions" id="userOption1" class="mr-2" disabled />
                            <label for="userOption1" class="cursor-pointer">Nuevos</label>
                        </div>
                        <div class="flex items-center px-3 py-2 bg-green-400/10">
                            <input type="radio" name="userOptions" id="userOption2" class="mr-2" />
                            <label for="userOption2" class="cursor-pointer">En
                                progreso</label>
                        </div>
                        <div class="flex items-center px-3 py-2 bg-red-400/10">
                            <input type="radio" name="userOptions" id="userOption3" class="mr-2" />
                            <label for="userOption3" class="cursor-pointer">Bloqueado</label>
                        </div>
                    </div>
                </div>

                <div class="my-1 h-px bg-gray-200 dark:bg-gray-700"></div>
                <button
                    class="block w-full rounded px-3 py-2 text-left text-red-600 hover:bg-gray-100 dark:hover:bg-gray-700">Eliminar</button>
            </div>
        </div>

    </main>

    


    <script>
        // Dropdowns y subdropdowns – generalizado
        (() => {
            // Utilidades
            const qs = (sel, ctx = document) => ctx.querySelector(sel);
            const qsa = (sel, ctx = document) => Array.from(ctx.querySelectorAll(sel));
            const getTarget = (el) => {
                const sel = el.getAttribute('data-target') || el.getAttribute('aria-controls');
                return sel ? qs(sel) : null;
            };
            const isOpen = (menu) => !menu.classList.contains('hidden');
            const open = (menu) => menu.classList.remove('hidden');
            const close = (menu) => menu.classList.add('hidden');

            // Cerrar otros menús del mismo grupo
            const closeGroupPeers = (menuToOpen) => {
                const group = menuToOpen.getAttribute('data-dd-group') || '__default__';
                qsa('[data-dropdown]').forEach(m => {
                    if (m === menuToOpen) return;
                    const g = m.getAttribute('data-dd-group') || '__default__';
                    if (g === group) close(m);
                });
            };

            // Cerrar submenús hermanos dentro del mismo contenedor padre
            const closeSiblingSubmenus = (submenu) => {
                const parent = submenu.parentElement?.parentElement; // contenedor del menú padre
                if (!parent) return;
                qsa('[data-dropdown-submenu]', parent).forEach(sm => {
                    if (sm !== submenu) close(sm);
                });
            };

            // Apertura/cierre de menús (captura para saltarse stopPropagation)
            const onDocClickOpen = (e) => {
                const trigger = e.target.closest('[data-dropdown-toggle]');
                if (!trigger) return;
                const menu = getTarget(trigger);
                if (!menu || !menu.hasAttribute('data-dropdown')) return;

                // Exclusividad por grupo
                closeGroupPeers(menu);

                // Toggle
                isOpen(menu) ? close(menu) : open(menu);
            };

            const onDocClickCloseButtons = (e) => {
                // Clic en cualquier botón que explícitamente cierre (opcional, si los usas)
                const closer = e.target.closest('[data-dropdown-close]');
                if (!closer) return;
                const menu = e.target.closest('[data-dropdown]') || getTarget(closer);
                if (menu) close(menu);
            };

            // Submenus
            const onDocClickSubToggle = (e) => {
                const subTrigger = e.target.closest('[data-dropdown-subtoggle]');
                if (!subTrigger) return;
                const submenu = getTarget(subTrigger);
                if (!submenu || !submenu.hasAttribute('data-dropdown-submenu')) return;

                // Cierra hermanos y togglear el actual
                closeSiblingSubmenus(submenu);
                isOpen(submenu) ? close(submenu) : open(submenu);
            };

            // Click fuera: cierra TODOS los menús abiertos
            const onOutside = (e) => {
                // Si el click fue dentro de algún menú o en un botón que lo abre, no cerrar
                if (e.target.closest('[data-dropdown]') || e.target.closest('[data-dropdown-toggle]')) return;
                qsa('[data-dropdown]').forEach(close);
            };

            // Tecla ESC: cierra todos
            const onEsc = (e) => {
                if (e.key !== 'Escape') return;
                qsa('[data-dropdown]').forEach(close);
            };

            // Listeners — en CAPTURA para ignorar stopPropagation en componentes internos
            document.addEventListener('click', onDocClickOpen, true);
            document.addEventListener('click', onDocClickCloseButtons, true);
            document.addEventListener('click', onDocClickSubToggle, true);
            document.addEventListener('pointerdown', onOutside, true);
            document.addEventListener('keydown', onEsc, true);
        })();
    </script>

</body>

</html>